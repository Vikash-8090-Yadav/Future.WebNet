(this["webpackJsonp@truffle/dashboard"]=this["webpackJsonp@truffle/dashboard"]||[]).push([[0],{147:function(e,t,n){"use strict";var r=n(66).default,s=n(260).default,a=n(87).default,i=n(65).default,o=n(106).default,c=n(108).default,u=n(262).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBusConnectionError=t.AlreadyRespondedError=void 0;var d=function(e){o(n,e);var t=c(n);function n(e){var r=e.serviceBusMessage;return i(this,n),t.call(this,"A response has already been sent for message id ".concat(r.id,' of type "').concat(r.type,'".'))}return n}(u(Error));t.AlreadyRespondedError=d;var l=function(e){o(n,e);var t=c(n);function n(e){var r,s=e.message,a=e.cause;return i(this,n),(r=t.call(this,s)).cause=a,r}return r(n,[{key:"toString",value:function(){return this.cause?"".concat(s(a(n.prototype),"toString",this).call(this),"\ncaused by: ").concat(this.cause.toString()):s(a(n.prototype),"toString",this).call(this)}}]),n}(u(Error));t.MessageBusConnectionError=l},149:function(e,t,n){"use strict";var r=n(1),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function o(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getOutstandingPromises=t.waitForOutstandingPromises=t.tracked=void 0;var a=new WeakMap,i=new Map;function o(e,t){a.has(e)||a.set(e,new Set),a.get(e).add(t),i.set(t,!0)}function c(e,t){i.delete(t);var n=a.get(e);null===n||void 0===n||n.delete(t),0===(null===n||void 0===n?void 0:n.size)&&a.delete(e)}t.tracked=function(e,t,n){if("function"!==typeof n.value||!e.constructor)throw new Error("The 'tracked' decorator can only be applied to methods.");var r=n.value;return Object.assign(Object.assign({},n),{value:function(){for(var e=this,t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var a=r.apply(this,n);if((null===a||void 0===a?void 0:a.then)&&"function"===typeof a.then){var i=a.finally((function(){c(e,i)}));return o(this,i),i}return a}})},t.waitForOutstandingPromises=function(e){var t;return s(this,void 0,void 0,r.mark((function n(){var s,o,c;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=(e||{}).target,o=(e||{}).catchHandler,c=(s?null===(t=a.get(s))||void 0===t?void 0:t.values():i.keys())||[],o=o||function(){},n.next=6,Promise.all(Array.from(c,(function(e){return e.catch(o)})));case 6:case"end":return n.stop()}}),n)})))},t.getOutstandingPromises=function(e){var t,n=e.target,r=(n?null===(t=a.get(n))||void 0===t?void 0:t.values():i.keys())||[];return Array.from(r)}},151:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(268),t),s(n(269),t)},166:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(229),t),s(n(270),t),s(n(151),t)},205:function(e,t){},213:function(e,t){},214:function(e,t){},215:function(e,t){},218:function(e,t){},219:function(e,t){},221:function(e,t){},222:function(e,t){},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInvalidateMessage=t.isDebugMessage=t.isLogMessage=t.isDashboardProviderMessage=t.invalidateMessageType=t.debugMessageType=t.logMessageType=t.dashboardProviderMessageType=void 0,t.dashboardProviderMessageType="provider",t.logMessageType="log",t.debugMessageType="debug",t.invalidateMessageType="invalidate";t.isDashboardProviderMessage=function(e){return e.type===t.dashboardProviderMessageType};t.isLogMessage=function(e){return e.type===t.logMessageType};t.isDebugMessage=function(e){return e.type===t.debugMessageType};t.isInvalidateMessage=function(e){return e.type===t.invalidateMessageType}},224:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.createMessage=t.base64ToJson=t.jsonToBase64=void 0;t.jsonToBase64=function(t){var n=JSON.stringify(t);return e.from(n).toString("base64")};t.base64ToJson=function(t){var n=e.from(t,"base64").toString("utf8");return JSON.parse(n)};t.createMessage=function(e,t){return{id:Math.random(),type:e,payload:t}}}).call(this,n(225).Buffer)},229:function(e,t,n){"use strict";var r=n(1),s=n(65).default,a=n(66).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function o(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardMessageBusClient=void 0;var c=n(50),u=n(230),d=o(n(150)),l=o(n(90)),f=n(151),h=n(149),p=l.default("dashboard-message-bus-client:client"),v=function(){function e(t){s(this,e),this._subscriptions=[],this._options=Object.assign({host:"localhost",port:24012,maxRetries:1,retryDelayMsec:100},null!==t&&void 0!==t?t:{});var n=this._options,r=n.host,a=n.port,i=n.publishPort,o=n.subscribePort;this._publishConnection=new u.DashboardMessageBusConnection({host:r,port:a,publishPort:i,connectionType:"publish"}),this._subscribeConnection=new u.DashboardMessageBusConnection({host:r,port:a,subscribePort:o,connectionType:"subscribe"}),this._subscribeConnection.on("message",this._messageHandler.bind(this))}return a(e,[{key:"options",get:function(){return Object.assign({},this._options)}},{key:"ready",value:function(){return i(this,void 0,void 0,r.mark((function e(){var t=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetriesAsync((function(){return i(t,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all([this._publishConnection.connect(),this._subscribeConnection.connect()]);case 1:case"end":return e.stop()}}),e,this)})))}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"publish",value:function(e){return i(this,void 0,void 0,r.mark((function t(){var n,s,a,o,u=this;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.type,s=e.payload,a=c.createMessage(n,s),t.prev=2,o=new f.PublishMessageLifecycle({message:a,connection:this._publishConnection}),t.next=6,this._withRetriesAsync(function(){return i(u,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p("publisher sending message %o",a),e.next=3,this._publishConnection.send(a);case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e,this)})))}.bind(this));case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(2),p("sending message %o failed due to error %s",a,t.t0),t.t0;case 13:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"subscribe",value:function(e){var t=new f.DashboardMessageBusSubscription(e);return this._subscriptions.push(t),t}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return i(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return t.next=3,this.waitForOutstandingPromises();case 3:return this._subscriptions.map((function(e){return e._end()})),this._subscriptions=[],t.next=7,Promise.all([this._subscribeConnection.close(),this._publishConnection.close()]);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"waitForOutstandingPromises",value:function(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.waitForOutstandingPromises({target:this});case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e,this)})))}},{key:"_messageHandler",value:function(e){var t=this;this._subscriptions.map((function(n){return n._evaluateMessage({message:e,connection:t._subscribeConnection})}))}},{key:"_withRetriesAsync",value:function(e){return i(this,void 0,void 0,r.mark((function t(){var n,s,a,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this._options,s=n.maxRetries,a=n.retryDelayMsec,i=0;case 2:if(!(i<=s)){t.next=28;break}if(t.prev=3,!(o=e.call(this)).then){t.next=11;break}return t.next=8,o;case 8:return t.abrupt("return",t.sent);case 11:return t.abrupt("return",o);case 12:t.next=25;break;case 14:if(t.prev=14,t.t0=t.catch(3),!(i<s)){t.next=23;break}return p("Attempt failed, %s of %s attempts remaining, delaying %s msec before retrying.",s-i,s+1,a),t.next=20,d.default(a);case 20:p("Retrying failed operation now"),t.next=25;break;case 23:throw p("Operation failed after %s attempts",i),t.t0;case 25:i++,t.next=2;break;case 28:case"end":return t.stop()}}),t,this,[[3,14]])})))}}]),e}();t.DashboardMessageBusClient=v},230:function(e,t,n){"use strict";var r=n(1),s=n(65).default,a=n(66).default,i=n(106).default,o=n(108).default,c=this&&this.__decorate||function(e,t,n,r){var s,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(i=(a<3?s(i):a>3?s(t,n,i):s(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function o(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardMessageBusConnection=void 0;var l=d(n(234)),f=d(n(235)),h=n(50),p=d(n(90)),v=n(147),b=n(148),g=n(149),y=d(n(150)),j=p.default("dashboard-message-bus-client:connection"),m=p.default("dashboard-message-bus-client:message"),x=function(e){i(n,e);var t=o(n);function n(e){var r,a=e.host,i=e.port,o=e.publishPort,c=e.subscribePort,u=e.connectionType;return s(this,n),(r=t.call(this))._host=a,r._port=i,r._publishPort=o,r._subscribePort=c,r._connectionType=u,r}return a(n,[{key:"isConnected",get:function(){return this._socket&&this._socket.readyState===l.default.OPEN}},{key:"isConnecting",get:function(){return this._socket&&this._socket.readyState===l.default.CONNECTING}},{key:"isClosing",get:function(){return this._socket&&this._socket.readyState===l.default.CLOSING}},{key:"connect",value:function(){var e;return u(this,void 0,void 0,r.mark((function t(){var n,s,a,i,o=this;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._socket){t.next=12;break}t.t0=this._socket.readyState,t.next=t.t0===l.default.CONNECTING?4:t.t0===l.default.OPEN?8:t.t0===l.default.CLOSING||t.t0===l.default.CLOSED?10:12;break;case 4:return j("connect: %s already attempting to connect (readyState switch)",this._connectionType),t.next=7,y.default(10);case 7:return t.abrupt("return",this.connect());case 8:return j("connect: %s already connected",this._connectionType),t.abrupt("return");case 10:j("connect: %s was previously connected but has been closed",this._connectionType),delete this._socket;case 12:if(t.prev=12,!this._connecting){t.next=18;break}return j("connect: %s already attempting to connect (_connecting flag)",this._connectionType),t.next=17,y.default(10);case 17:return t.abrupt("return",this.connect());case 18:return this._connecting=!0,t.next=21,this._getMessageBusPort();case 21:return n=t.sent,s="ws://".concat(this._host,":").concat(n),j("connect: %s is attempting to connect to %s",this._connectionType,s),this._socket=new l.default(s),null===(e=this._socket)||void 0===e||e.addEventListener("message",function(e){"string"!==typeof e.data&&(e.data=e.data.toString());var t=h.base64ToJson(e.data);m("%s connection received message %o",o._connectionType,t),o.emit("message",t)}.bind(this)),a=this._createEventWrapperPromise((function(e,t){return{open:function(){var t,n;j("connect: %s connection succeeded to url %s",o._connectionType,null===(t=o._socket)||void 0===t?void 0:t.url),"subscribe"===o._connectionType&&(null===(n=o._socket)||void 0===n||n.send("ready")),e(),o._connecting=!1},error:function(e){var n;j("connect: %s connection to url %s failed due to error %s",o._connectionType,null===(n=o._socket)||void 0===n?void 0:n.url,e.error),t(new v.MessageBusConnectionError({message:e.error.message,cause:e.error})),o._connecting=!1},close:function(e){var n;j("connect: %s connection to url %s closed before successfully connecting due to code %s and reason %s",o._connectionType,null===(n=o._socket)||void 0===n?void 0:n.url,e.code,e.reason),t(new v.MessageBusConnectionError({message:"Socket connection closed with code '".concat(e.code,"' and reason '").concat(e.reason,"'")})),o._connecting=!1}}})),i=!1,t.next=30,Promise.race([a,function(){return u(o,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.default(350);case 2:i=!0;case 3:case"end":return e.stop()}}),e)})))}]);case 30:i&&j("connect: %s connection to url %s timed out",this._connectionType,s),t.next=36;break;case 33:t.prev=33,t.t1=t.catch(12),this._connecting=!1;case 36:case"end":return t.stop()}}),t,this,[[12,33]])})))}},{key:"send",value:function(e){var t;return u(this,void 0,void 0,r.mark((function n(){var s;return r.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s="string"===typeof e?e:h.jsonToBase64(e),n.next=3,this.connect();case 3:j("send: %s connection sending %o",this._connectionType,h.base64ToJson(s)),null===(t=this._socket)||void 0===t||t.send(s);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"close",value:function(){return u(this,void 0,void 0,r.mark((function e(){var t,n=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._socket){e.next=2;break}return e.abrupt("return");case 2:if(!(this._socket.readyState<=l.default.CLOSING)){e.next=6;break}return t=this._createEventWrapperPromise((function(e,t){return{error:function(e){t(e.error)},close:function(){j("%s connection closed",n._connectionType),e()}}})),this._socket.close(),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"_getMessageBusPort",value:function(){return u(this,void 0,void 0,r.mark((function e(){var t,n,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("subscribe"!==this._connectionType||!this._subscribePort){e.next=2;break}return e.abrupt("return",this._subscribePort);case 2:if("publish"!==this._connectionType||!this._publishPort){e.next=4;break}return e.abrupt("return",this._publishPort);case 4:return e.prev=4,j("_getMessageBusPort: %s connection attempting to fetch ports",this._connectionType),e.next=8,f.default.get("http://".concat(this._host,":").concat(this._port,"/ports"),{timeout:350});case 8:return t=e.sent,n=t.data,s="subscribe"===this._connectionType?n.subscribePort:n.publishPort,j("_getMessageBusPort: %s connection will use port %s",this._connectionType,s),e.abrupt("return",s);case 15:throw e.prev=15,e.t0=e.catch(4),j("_getMessageBusPort: failed fetching ports for %s connection due to error %s",this._connectionType,e.t0),e.t0;case 19:case"end":return e.stop()}}),e,this,[[4,15]])})))}},{key:"_createEventWrapperPromise",value:function(e){var t=this;return new Promise(function(n,r){t._registerEventHandlers(e.call(t,n,r))}.bind(this))}},{key:"_registerEventHandlers",value:function(e){var t,n=this,r={},s=function(s){r[s]=function(){for(var t,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];(t=e[s]).call.apply(t,[n].concat(i)),n._cleanUpEventHandlers(r)}.bind(n),null===(t=n._socket)||void 0===t||t.addEventListener(s,r[s])};for(var a in e)s(a)}},{key:"_cleanUpEventHandlers",value:function(e){var t;for(var n in e)null===(t=this._socket)||void 0===t||t.removeEventListener(n,e[n])}}]),n}(b.TypedEmitter);c([g.tracked],x.prototype,"send",null),t.DashboardMessageBusConnection=x},268:function(e,t,n){"use strict";var r=n(1),s=n(65).default,a=n(66).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function o(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PublishMessageLifecycle=void 0;var c=n(50),u=o(n(90)).default("dashboard-message-bus-client:publish"),d=function(){function e(t){var n=this,r=t.message,a=t.connection;s(this,e),this._responseReceived=!1,this._invalidated=!1,this._abandoned=!1,this.message=r,this._connection=a,this._messageHandler=this._messageHandler.bind(this),this.response=new Promise((function(e){n._responsePromiseResolve=e})),a.on("message",this._messageHandler)}return a(e,[{key:"invalidate",value:function(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._abandoned||this._invalidated||this._responseReceived)){e.next=2;break}return e.abrupt("return");case 2:return this._invalidated=!0,this._connection.off("message",this._messageHandler),this._responsePromiseResolve(null),e.next=7,this._connection.send(c.createMessage(c.invalidateMessageType,this.message.id));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"abandon",value:function(){return i(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._abandoned||this._invalidated||this._responseReceived)){e.next=2;break}return e.abrupt("return");case 2:this._abandoned=!0,this._connection.off("message",this._messageHandler),this._responsePromiseResolve(null);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"_messageHandler",value:function(e){return e.id===this.message.id?(this._responseReceived=!0,this._connection.off("message",this._messageHandler),u("Received response %o for message %s of type '%s'",e,this.message.id,this.message.type),this._responsePromiseResolve(e)):function(e){var t=e.response,n=e.message;if(t.type!==c.invalidateMessageType&&n.type!==c.invalidateMessageType)return!1;return t.payload===n.id}({response:e,message:this.message})?(this._invalidated=!0,this._connection.off("message",this._messageHandler),u("Message id %s of type '%s' was invalidated.",this.message.id,this.message.type),this._responsePromiseResolve(null)):void 0}}]),e}();t.PublishMessageLifecycle=d},269:function(e,t,n){"use strict";var r=n(1),s=n(65).default,a=n(66).default,i=n(106).default,o=n(108).default,c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function o(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}c((r=r.apply(e,t||[])).next())}))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ReceivedMessageLifecycle=t.DashboardMessageBusSubscription=void 0;var d=n(147),l=u(n(90)),f=n(148),h=l.default("dashboard-message-bus-client:subscribe"),p=function(e){i(n,e);var t=o(n);function n(e){var r,a=e.id,i=e.type;return s(this,n),(r=t.call(this))._ended=!1,r._predicate=function(e){return(void 0===a||e.id===a)&&(void 0===i||e.type===i)},r}return a(n,[{key:"_evaluateMessage",value:function(e){var t=e.message,n=e.connection;if(this._predicate(t)){var r=new v({message:t,connection:n});this.emit("message",r)}}},{key:"_end",value:function(){this._ended=!0,this.emit("end"),this.removeAllListeners()}}]),n}(f.TypedEmitter);t.DashboardMessageBusSubscription=p;var v=function(){function e(t){var n=t.message,r=t.connection;s(this,e),this._responded=!1,this.message=n,this._connection=r}return a(e,[{key:"respond",value:function(e){var t=e.payload;return c(this,void 0,void 0,r.mark((function e(){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._responded){e.next=2;break}throw new d.AlreadyRespondedError({serviceBusMessage:this.message});case 2:return this._responded=!0,n={id:this.message.id,payload:t},h("Responding to message %s of type '%s' with %o",this.message.id,this.message.type,n),e.next=7,this._connection.send(n);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}();t.ReceivedMessageLifecycle=v},270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},271:function(e,t,n){},272:function(e,t,n){"use strict";n.r(t);var r=n(10),s=n.n(r),a=n(152),i=n.n(a),o=n(29),c=n(26),u=n(153),d=n(12),l=n(1),f=n.n(l),h=n(35),p=n(62),v=n(168);function b(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}var g=n(9),y=["children","className","color","size","variant","startIcon","endIcon","fullWidth","loading","disabled"],j={xs:"py-1 px-2 h-[28px] !border",sm:"py-2 px-2 h-[36px]",md:"px-2 h-[52px]",lg:"p-2 "},m={xs:"text-xs rounded-xl",sm:"text-sm rounded-l",lg:"text-lg rounded"},x={outlined:{default:"border-2 border-truffle-blue disabled:pointer-events-none disabled:opacity-40",blue:"border-none text-truffle-blue bg-truffle-blue bg-opacity-20 hover:bg-truffle-blue hover:bg-opacity-40 focus:bg-truffle-blue focus:bg-opacity-40 active:bg-truffle-blue active:bg-opacity-40",red:"border-none text-truffle-red bg-truffle-red bg-opacity-20 hover:bg-truffle-red hover:bg-opacity-40 focus:bg-truffle-red focus:bg-opacity-40 active:bg-truffle-red active:bg-opacity-40",brown:"border-none text-truffle-brown bg-truffle-brown bg-opacity-20 hover:bg-truffle-brown hover:bg-opacity-40 focus:bg-truffle-brown focus:bg-opacity-40 active:bg-truffle-brown active:bg-opacity-40"},filled:{default:"rounded bg-truffle-blue uppercase hover:bg-truffle-light",blue:"bg-truffle-blue",red:"bg-truffle-red text-truffle-lighter hover:text-black",brown:"bg-truffle-brown text-truffle-lighter hover:text-black"},empty:{default:"bg-transparent hover:brightness-[90%] focus:brightness-[90%] active:brightness-[80%] disabled:pointer-events-none disabled:opacity-40",blue:"text-truffle-blue",red:"text-truffle-red",brown:"text-truffle-brown"}},_=s.a.forwardRef((function(e,t){var n=e.children,r=e.className,s=void 0===r?"":r,a=e.color,i=void 0===a?"blue":a,o=e.size,c=void 0===o?"lg":o,u=e.variant,d=void 0===u?"filled":u,l=e.startIcon,f=void 0===l?void 0:l,h=e.endIcon,_=void 0===h?void 0:h,O=e.fullWidth,w=void 0!==O&&O,k=e.loading,P=e.disabled,M=Object(v.a)(e,y);return Object(g.jsx)("button",Object(p.a)(Object(p.a)({},M),{},{ref:t,disabled:P||k,className:b(x[d].default,x[d][i],m[c],"empty"!==d?j[c]:"",w?"w-full":"","mx-2",s),children:Object(g.jsxs)(g.Fragment,{children:[f&&f,n,_&&_]})}))})),O=n(154),w=n.n(O),k=n(155),P=["eth_signTransaction","eth_sendTransaction","eth_decrypt","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign"],M=["eth_sign"],T=function(e){return P.includes(e.message.payload.method)},C=function(e){return M.includes(e.message.payload.method)},N=function(){var e=Object(c.a)(f.a.mark((function e(t,n,r){var s,a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("forwardDashboardProviderRequest:input",{id:r.id,provider:t,connector:n,payload:r}),s=Object(k.promisify)(t.sendAsync.bind(t)),e.prev=2,e.next=5,s(r);case 5:if(a=e.sent,i=null===n||void 0===n?void 0:n.id,console.debug("forwardDashboardProviderRequest:result",{id:r.id,payload:r,result:a}),"injected"!==i){e.next=12;break}return e.abrupt("return",a);case 12:return e.abrupt("return",{jsonrpc:r.jsonrpc,id:r.id,result:a});case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",{jsonrpc:r.jsonrpc,id:r.id,error:e.t0});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t,n,r){return e.apply(this,arguments)}}(),D=function(){var e=Object(c.a)(f.a.mark((function e(t,n,r){var s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(n,r,t.message.payload);case 2:return s=e.sent,e.abrupt("return",t.respond({payload:s}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),S=function(){var e=Object(c.a)(f.a.mark((function e(t){var n,r,s,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r='Method "'.concat(t.message.payload.method,'" is unsupported by @truffle/dashboard'),s=null!==(n={eth_sign:'Method "eth_sign" is unsupported by @truffle/dashboard, please use "personal_sign" instead'}[t.message.payload.method])&&void 0!==n?n:r,4001,a={jsonrpc:t.message.payload.jsonrpc,id:t.message.payload.id,error:{code:4001,message:s}},e.abrupt("return",t.respond({payload:a}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(c.a)(f.a.mark((function e(t){var n,r,s,a,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("https://chainid.network/chains.json");case 2:if(n=e.sent,r=n.data,s=r.filter((function(e){return e.chainId===t})),a=Object(d.a)(s,1),i=a[0]){e.next=7;break}return e.abrupt("return","Chain ID ".concat(t));case 7:return e.abrupt("return",i.name);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(c.a)(f.a.mark((function e(t,n){var r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t,n);case 2:return r=e.sent,s=I(n),e.abrupt("return",null!==r&&void 0!==r?r:s);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(c.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.lookupAddress(n);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",void 0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),I=function(e){return"".concat(e.slice(0,6),"...").concat(e.slice(-4))};var A=function(e){var t=e.chainId,n=Object(r.useState)("Chain ID ".concat(t)),s=Object(d.a)(n,2),a=s[0],i=s[1],o=1===t?"text-truffle-red":"";return Object(r.useEffect)((function(){var e=function(){var e=Object(c.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:n=e.sent,i(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t&&e(t)}),[t]),Object(g.jsx)("div",{className:"rounded uppercase ".concat(o),children:a})};var L=function(e){var t=e.header,n=e.body,r=e.footer,s=t&&Object(g.jsx)("div",{className:"border-b border-grey py-3 mx-3",children:Object(g.jsx)("h2",{className:"text-center uppercase",children:t})}),a=n&&Object(g.jsx)("div",{className:"p-3 overflow-auto",children:n}),i=r&&Object(g.jsx)("div",{className:"border-t border-grey py-3 mx-3",children:r});return Object(g.jsxs)("div",{className:"border-grey border rounded bg-white w-full",children:[s,a,i]})};var H=function(e){var t=e.confirm,n=e.newChainId,r=e.previousChainId,s=Object(g.jsxs)("div",{className:"flex flex-col gap-2",children:[Object(g.jsx)("div",{children:"We detected that your connected network changed. Please confirm that this was your intention or switch back to the previous network."}),Object(g.jsx)("div",{children:"Your previous connected network was:"}),Object(g.jsx)("div",{className:"flex justify-center",children:Object(g.jsx)(A,{chainId:r})}),Object(g.jsx)("div",{children:"Your new connected network is:"}),Object(g.jsx)("div",{className:"flex justify-center",children:Object(g.jsx)(A,{chainId:n})})]}),a=Object(g.jsx)(_,{onClick:t,children:"Confirm"});return Object(g.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(g.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3 text-center",children:Object(g.jsx)(L,{header:"Confirm Network Changed",body:s,footer:a})})})};var q=function(e){var t,n,s=e.disconnect,a=Object(r.useState)(),i=Object(d.a)(a,2),o=i[0],u=i[1],l=Object(h.b)(),p=Object(d.a)(l,1)[0].data,v=Object(h.d)(),b=Object(d.a)(v,1)[0].data,y=Object(h.c)(),j=Object(d.a)(y,1)[0].data;return Object(r.useEffect)((function(){var e,t=function(){var e=Object(c.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=u,e.next=3,R(t,n);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();j.connected||u(void 0),j&&p&&t(null===(e=j.connector)||void 0===e?void 0:e.getProvider(),p.address)}),[j,p]),Object(g.jsxs)("header",{className:"grid grid-cols-2 py-2 px-4 border-b-2 border-truffle-light text-md uppercase",children:[Object(g.jsx)("div",{className:"flex justify-start items-center",children:Object(g.jsxs)("span",{className:"inline-flex items-center gap-3",children:[Object(g.jsx)("img",{src:"/truffle-logomark.svg",width:"32px",alt:"Truffle Logo"}),"Truffle Dashboard"]})}),Object(g.jsxs)("div",{className:"flex justify-end items-center gap-4 text-md",children:[(null===(t=b.chain)||void 0===t?void 0:t.id)&&Object(g.jsx)(A,{chainId:b.chain.id}),(null===(n=b.chain)||void 0===n?void 0:n.id)&&Object(g.jsx)(_,{onClick:s,size:"sm",color:"red",children:"disconnect"}),Object(g.jsx)("div",{children:o})]})]})},W=n(81),J=n.n(W);var F=function(e){var t=e.provider,n=e.connector,s=e.request,a=e.setRequests,i=Object(r.useState)(!1),o=Object(d.a)(i,2),u=o[0],l=o[1],h=function(){a((function(e){return e.filter((function(e){return e.message.id!==s.message.id}))}))},p=function(){var e=Object(c.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,D(s,t,n);case 3:h();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(c.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={jsonrpc:s.message.payload.jsonrpc,id:s.message.payload.id,error:{code:4001,message:"User rejected @truffle/dashboard request"}},s.respond({payload:t}),h();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=Object(g.jsx)("div",{className:"normal-case",children:s.message.payload.method}),y=Object(g.jsx)("div",{children:function(e){switch(e.payload.method){case"eth_sendTransaction":case"eth_signTransaction":var t=Object(d.a)(e.payload.params,1)[0];return Object(g.jsx)(J.a,{name:"transaction",src:t});case"eth_signTypedData_v1":case"eth_signTypedData":var n=Object(d.a)(e.payload.params,2),r=n[0],s=n[1];return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:["Account: ",s]}),Object(g.jsxs)("div",{className:"flex gap-2",children:[Object(g.jsx)("div",{children:"Message:"}),Object(g.jsx)(J.a,{name:"message params",src:r})]})]});case"eth_signTypedData_v3":case"eth_signTypedData_v4":var a=Object(d.a)(e.payload.params,2),i=a[0],o=a[1],c=JSON.parse(o).message;return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:["Account: ",i]}),Object(g.jsxs)("div",{className:"flex gap-2",children:[Object(g.jsx)("div",{children:"Message:"}),Object(g.jsx)(J.a,{name:"message",src:c})]})]});case"personal_sign":var u=Object(d.a)(e.payload.params,2),l=u[0],f=u[1];return Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{children:["Account: ",f]}),Object(g.jsxs)("div",{className:"flex gap-2",children:[Object(g.jsx)("div",{children:"Message:"}),Object(g.jsx)("div",{children:l})]})]});default:return Object(g.jsx)(J.a,{src:e.payload.params})}}(s.message)}),j=u?Object(g.jsx)("div",{className:"flex justify-start items-center gap-2",children:Object(g.jsx)(_,{disabled:!0,onClick:function(){},children:"Processing..."})}):Object(g.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[Object(g.jsx)(_,{onClick:function(){p(),l(!0)},children:"Process"}),Object(g.jsx)(_,{onClick:v,children:"Reject"})]});return Object(g.jsx)("div",{className:"flex justify-center items-center",children:Object(g.jsx)(L,{header:b,body:y,footer:j})},s.message.id)};var G=function(e){var t,n=e.paused,s=e.requests,a=e.setRequests,i=Object(h.c)(),o=Object(d.a)(i,1)[0].data,c=null===(t=o.connector)||void 0===t?void 0:t.getProvider(),u=o.connector;Object(r.useEffect)((function(){var e=function(e){a((function(t){return t.filter((function(t){return t.message.id!==e}))}))};o.connected&&c&&(n||(s.filter(C).forEach((function(t){S(t),e(t.message.id)})),s.filter((function(e){return!T(e)&&!C(e)})).forEach((function(t){D(t,c,u),e(t.message.id)}))))}),[n,s,a,o,c,u]);var l=o.connected&&c?s.filter(T).map((function(e){return Object(g.jsx)(F,{request:e,setRequests:a,provider:c,connector:u})})):[];return Object(g.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(g.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3",children:Object(g.jsx)(L,{header:"Incoming Requests",body:l})})})};var z=function(e){var t,n=e.confirm,r=Object(h.c)(),s=Object(d.a)(r,2),a=s[0].data,i=s[1],o=Object(h.d)(),c=null===(t=Object(d.a)(o,1)[0].data.chain)||void 0===t?void 0:t.id,u=Object(g.jsx)("div",{children:a.connectors.map((function(e){return Object(g.jsx)(_,{onClick:function(){return i(e)},children:e.name},e.id)}))}),l=c&&Object(g.jsxs)("div",{className:"flex flex-col gap-2",children:[Object(g.jsx)("div",{children:"Please confirm you're connected to the right network (or switch to the right one) before continuing."}),Object(g.jsx)("div",{className:"flex justify-center",children:Object(g.jsx)(A,{chainId:c})})]}),f=Object(g.jsx)(_,{onClick:n,children:"Confirm"});return Object(g.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(g.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3 text-center",children:void 0===c?Object(g.jsx)(L,{header:"Connect Wallet",body:"Please connect your wallet to use the Truffle Dashboard Provider.",footer:u}):Object(g.jsx)(L,{header:"Connect Wallet",body:l,footer:f})})})},U=n(50),Y=n(166);var K=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(),i=Object(d.a)(a,2),l=i[0],p=i[1],v=Object(r.useState)(),b=Object(d.a)(v,2),y=b[0],j=b[1],m=Object(r.useState)(),x=Object(d.a)(m,2),_=x[0],O=x[1],w=Object(r.useState)([]),k=Object(d.a)(w,2),P=k[0],M=k[1],T=Object(h.d)(),C=Object(d.a)(T,1)[0].data,N=Object(h.b)(),D=Object(d.a)(N,2);Object(u.a)(D[0]);var S=D[1],E=Object(h.c)(),R=Object(d.a)(E,1)[0].data;Object(r.useEffect)((function(){j(y),y&&_&&(l?(l!==y&&s(!0),l===y&&s(!1)):p(y))}),[C,R,_,y,l]);var B=function(){var e=Object(c.a)(f.a.mark((function e(){var t,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=4;break}return e.next=3,_.ready();case 3:return e.abrupt("return");case 4:return t=window.location.hostname,n=Number(window.location.port),r=new Y.DashboardMessageBusClient({host:t,port:n}),e.next=9,r.ready();case 9:console.debug("Connected to message bus at ws://".concat(t,":").concat(n)),r.subscribe({}).on("message",(function(e){var t=e.message;if(Object(U.isDashboardProviderMessage)(t))console.debug("received provider message",t),M((function(t){return[].concat(Object(o.a)(t),[e])}));else if(Object(U.isInvalidateMessage)(t))console.debug("received invalidate message ",t),M((function(e){return e.filter((function(e){return e.message.id!==t.payload}))}));else if(Object(U.isDebugMessage)(t)){console.debug("received invalidate message ",t);var n=t.payload;console.log(n.message),e.respond({payload:void 0})}else if(Object(U.isLogMessage)(t)){console.debug("received log message ",t);var r=t.payload;console.log(r.message),e.respond({payload:void 0})}})),O(r);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{className:"h-full min-h-screen bg-gradient-to-b from-truffle-lighter to-truffle-light",children:[Object(g.jsx)(q,{disconnect:function(){console.debug("Disconnecting"),S(),p(void 0),s(!1),null===_||void 0===_||_.close(),O(void 0)}}),n&&y&&l&&Object(g.jsx)(H,{newChainId:y,previousChainId:l,confirm:function(){return p(y)}}),!n&&!_&&Object(g.jsx)(z,{confirm:B}),!n&&_&&Object(g.jsx)(G,{paused:n,requests:P,setRequests:M})]})},Q=n(22),V=n(167),X=n(56),Z=n(48),$=n(76),ee=Q.j.mainnet,te=function(e){var t,n,r,s=null===(t=e.connector)||void 0===t?void 0:t.getProvider(!0);(console.debug("getProvider",{wProvider:s,winEth:window.ethereum,_config:e}),s)?(s.enable().then((function(e){return console.debug(e)})).catch((function(e){return console.error(e)})),n=new Z.providers.Web3Provider(s)):n=Object(X.getDefaultProvider)(Object($.a)(null!==(r=e.chainId)&&void 0!==r?r:ee.id));return console.debug("getProvider.returning",{wProvider:s,winEth:window.ethereum,ret:n}),n},ne=[new V.a({chains:Q.h})];var re=function(){return Object(g.jsx)(h.a,{connectors:ne,provider:te,children:Object(g.jsx)(K,{})})};n(271);i.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(re,{})}),document.getElementById("root"))},50:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(223),t),s(n(224),t)}},[[272,1,2]]]);
//# sourceMappingURL=main.98bda59f.chunk.js.map