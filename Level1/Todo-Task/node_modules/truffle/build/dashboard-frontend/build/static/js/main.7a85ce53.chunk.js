(this["webpackJsonp@truffle/dashboard"]=this["webpackJsonp@truffle/dashboard"]||[]).push([[0],{112:function(e,t,r){"use strict";var n=r(0),s=r(113).default,a=r(114).default,c=r(115).default,i=r(117).default,o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,a){function c(e){try{o(n.next(e))}catch(t){a(t)}}function i(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,i)}o((n=n.apply(e,t||[])).next())}))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardMessageBus=void 0;var d=u(r(57)),l=r(51),f=r(58),h=r(54),b=function(e){c(r,e);var t=i(r);function r(e,n){var a,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"localhost";return s(this,r),(a=t.call(this)).publishPort=e,a.subscribePort=n,a.host=c,a.publishers=[],a.subscribers=[],a.unfulfilledRequests=new Map([]),a}return a(r,[{key:"start",value:function(){return o(this,void 0,void 0,n.mark((function e(){var t=this;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.startWebSocketServer({host:this.host,port:this.subscribePort});case 2:return this.subscribeServer=e.sent,this.subscribeServer.on("connection",(function(e){e.on("close",(function(){t.removeSubscriber(e)})),e.once("message",(function(){return t.addSubscriber(e)}))})),e.next=6,f.startWebSocketServer({host:this.host,port:this.publishPort});case 6:this.publishServer=e.sent,this.publishServer.on("connection",(function(e){e.on("close",(function(){t.removePublisher(e)})),t.addPublisher(e)}));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"ready",value:function(){return o(this,void 0,void 0,n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.subscribers.length){e.next=5;break}return e.next=3,d.default(1e3);case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e,this)})))}},{key:"terminate",value:function(){return o(this,void 0,void 0,n.mark((function e(){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.promisify(this.publishServer.close.bind(this.publishServer))();case 2:return e.next=4,h.promisify(this.subscribeServer.close.bind(this.subscribeServer))();case 4:this.emit("terminate");case 5:case"end":return e.stop()}}),e,this)})))}},{key:"processRequest",value:function(e,t,r){return o(this,void 0,void 0,n.mark((function s(){var a,c,i;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return"string"!==typeof t&&(t=t.toString()),n.next=3,this.ready();case 3:return this.unfulfilledRequests.set(t,{publisher:e,data:t}),a=f.base64ToJson(t),n.prev=5,this.logToPublishers("Sending message to ".concat(r.length," subscribers"),"requests"),this.logToPublishers(a,"requests"),n.next=10,f.broadcastAndAwaitFirst(r,a);case 10:c=n.sent,this.logToPublishers("Sending response for message ".concat(a.id),"responses"),this.logToPublishers(c,"responses"),i=f.jsonToBase64(c),e.send(i),this.unfulfilledRequests.delete(t),this.invalidateMessage(a.id),n.next=23;break;case 19:n.prev=19,n.t0=n.catch(5),this.logToPublishers("An error occurred while processing message ".concat(a.id),"errors"),this.logToPublishers(n.t0,"errors");case 23:case"end":return n.stop()}}),s,this,[[5,19]])})))}},{key:"invalidateMessage",value:function(e){var t=f.createMessage("invalidate",e);f.broadcastAndDisregard(this.subscribers,t)}},{key:"logToPublishers",value:function(e,t){this.logTo(e,this.publishers,t)}},{key:"logToSubscribers",value:function(e,t){this.logTo(e,this.subscribers,t)}},{key:"logToAll",value:function(e,t){this.logToPublishers(e,t),this.logToSubscribers(e,t)}},{key:"logTo",value:function(e,t,r){var n={namespace:"dashboard-message-bus",message:e};r&&(n.namespace+=":".concat(r));var s=f.createMessage("log",n);f.broadcastAndDisregard(t,s)}},{key:"addSubscriber",value:function(e){var t=this;this.unfulfilledRequests.forEach((function(r){var n=r.publisher,s=r.data;return t.processRequest(n,s,[e])})),this.logToPublishers("Subscriber connected","connections"),this.subscribers.push(e)}},{key:"removeSubscriber",value:function(e){this.logToPublishers("Subscriber disconnected","connections"),this.subscribers=this.subscribers.filter((function(t){return t!==e})),this.terminateIfNoConnections()}},{key:"addPublisher",value:function(e){var t=this;this.logToPublishers("Publisher connected","connections"),e.on("message",(function(r){t.processRequest(e,r,t.subscribers)})),this.publishers.push(e)}},{key:"removePublisher",value:function(e){this.logToPublishers("Publisher disconnected","connections"),this.publishers=this.publishers.filter((function(t){return t!==e})),this.clearRequestsForPublisher(e),this.terminateIfNoConnections()}},{key:"terminateIfNoConnections",value:function(){0===this.publishers.length&&0===this.subscribers.length&&this.terminate()}},{key:"clearRequestsForPublisher",value:function(e){var t=this;this.unfulfilledRequests.forEach((function(r,n){r.publisher===e&&t.unfulfilledRequests.delete(n)}))}}]),r}(l.EventEmitter);t.DashboardMessageBus=b},154:function(e,t){},18:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(112),t),s(r(58),t),s(r(219),t)},219:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(220),t)},220:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInvalidateMessage=t.isLogMessage=t.isDashboardProviderMessage=void 0;t.isDashboardProviderMessage=function(e){return"provider"===e.type};t.isLogMessage=function(e){return"log"===e.type};t.isInvalidateMessage=function(e){return"invalidate"===e.type}},221:function(e,t){},222:function(e,t){},231:function(e,t,r){},232:function(e,t,r){"use strict";r.r(t);var n=r(6),s=r.n(n),a=r(94),c=r.n(a),i=r(8),o=r(9),u=r(0),d=r.n(u),l=r(18),f=r(53),h=r.n(f),b=r(239),v=r(54),p=["eth_signTransaction","eth_sendTransaction","eth_decrypt","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign"],j=["eth_sign"],x=function(){var e=Object(o.a)(d.a.mark((function e(){var t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.hostname,r=Number(window.location.port),e.abrupt("return",Object(l.getMessageBusPorts)(r,t));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e){return p.includes(e.payload.method)},m=function(e){return j.includes(e.payload.method)},O=function(){var e=Object(o.a)(d.a.mark((function e(t,r){var n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(v.promisify)(t.sendAsync.bind(t)),e.prev=1,e.next=4,n(r);case 4:return s=e.sent,e.abrupt("return",s);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{jsonrpc:r.jsonrpc,id:r.id,error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=Object(o.a)(d.a.mark((function e(t,r,n){var s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(r,t.payload);case 2:s=e.sent,a={id:t.id,payload:s},w(a,n);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),w=function(e,t){console.debug("Sending response",e);var r=Object(l.jsonToBase64)(e);t.send(r)},k=function(e){return new b.a.Web3Provider(e)},_=function(){var e=Object(o.a)(d.a.mark((function e(t){var r,n,s,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("https://chainid.network/chains.json");case 2:if(r=e.sent,n=r.data,s=n.filter((function(e){return e.chainId===t})),a=Object(i.a)(s,1),c=a[0]){e.next=7;break}return e.abrupt("return","Chain ID ".concat(t));case 7:return e.abrupt("return",c.name);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(o.a)(d.a.mark((function e(t,r){var n,s,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t,r);case 2:return n=e.sent,s=S(r),a=null!==n&&void 0!==n?n:s,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),T=function(){var e=Object(o.a)(d.a.mark((function e(t,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.lookupAddress(r);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",void 0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,r){return e.apply(this,arguments)}}(),S=function(e){return"".concat(e.slice(0,6),"...").concat(e.slice(-4))},M=r(16),N=r(101),C=r(52),q=r.n(C),A=r(100),D=r(1);var I=function(e){var t=e.chainId,r=Object(n.useState)("Chain ID ".concat(t)),s=Object(i.a)(r,2),a=s[0],c=s[1],u=1===t?"text-truffle-red":"";return Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t);case 2:r=e.sent,c(r),console.log(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t&&e(t)}),[t]),Object(D.jsx)("div",{className:"rounded uppercase ".concat(u),children:a})};var E=function(e){Object(A.a)(e);var t=Object(n.useState)(),r=Object(i.a)(t,2),s=r[0],a=r[1],c=Object(M.b)(),u=c.account,l=c.library,f=c.chainId;return Object(n.useEffect)((function(){var e=function(){var e=Object(o.a)(d.a.mark((function e(t,r){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,P(t,r);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();l&&u&&e(l,u)}),[l,u]),Object(D.jsxs)("header",{className:"grid grid-cols-2 py-2 px-4 border-b-2 border-truffle-light text-md uppercase",children:[Object(D.jsx)("div",{className:"flex justify-start items-center",children:Object(D.jsxs)("span",{className:"inline-flex items-center gap-3",children:[Object(D.jsx)("img",{src:"/truffle-logomark.svg",width:"32px"}),"Truffle Dashboard"]})}),Object(D.jsxs)("div",{className:"flex justify-end items-center gap-4 text-md",children:[f&&Object(D.jsx)(I,{chainId:f}),Object(D.jsx)("div",{children:s})]})]})};var B=function(e){var t=e.header,r=e.body,n=e.footer,s=t&&Object(D.jsx)("div",{className:"border-b border-grey py-3 mx-3",children:Object(D.jsx)("h2",{className:"text-center uppercase",children:t})}),a=r&&Object(D.jsx)("div",{className:"p-3 overflow-auto",children:r}),c=n&&Object(D.jsx)("div",{className:"border-t border-grey py-3 mx-3",children:n});return Object(D.jsxs)("div",{className:"border-grey border rounded bg-white w-full",children:[s,a,c]})},R=r(28),W=r.n(R);var J=function(e){var t=e.disabled,r=e.onClick,n=e.text;return Object(D.jsx)("button",{className:"rounded p-2 "+(t?"":"bg-truffle-blue")+" text-truffle-brown uppercase hover:bg-white",disabled:t,onClick:r,children:n})};var L=function(e){var t=e.provider,r=e.socket,s=e.request,a=e.setRequests,c=Object(n.useState)(!1),u=Object(i.a)(c,2),l=u[0],f=u[1],h=function(){a((function(e){return e.filter((function(e){return e.id!==s.id}))}))},b=function(){var e=Object(o.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(s,t,r);case 2:h();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={id:s.id,payload:{jsonrpc:s.payload.jsonrpc,id:s.payload.id,error:{code:4001,message:"User rejected @truffle/dashboard request"}}},w(t,r),h();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=Object(D.jsx)("div",{className:"normal-case",children:s.payload.method}),j=Object(D.jsx)("div",{children:function(e){switch(e.payload.method){case"eth_sendTransaction":case"eth_signTransaction":var t=Object(i.a)(e.payload.params,1)[0];return Object(D.jsx)(W.a,{name:"transaction",src:t});case"eth_signTypedData_v1":case"eth_signTypedData":var r=Object(i.a)(e.payload.params,2),n=r[0],s=r[1];return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{children:["Account: ",s]}),Object(D.jsxs)("div",{className:"flex gap-2",children:[Object(D.jsx)("div",{children:"Message:"}),Object(D.jsx)(W.a,{name:"message params",src:n})]})]});case"eth_signTypedData_v3":case"eth_signTypedData_v4":var a=Object(i.a)(e.payload.params,2),c=a[0],o=a[1],u=JSON.parse(o).message;return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{children:["Account: ",c]}),Object(D.jsxs)("div",{className:"flex gap-2",children:[Object(D.jsx)("div",{children:"Message:"}),Object(D.jsx)(W.a,{name:"message",src:u})]})]});case"personal_sign":var d=Object(i.a)(e.payload.params,2),l=d[0],f=d[1];return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{children:["Account: ",f]}),Object(D.jsxs)("div",{className:"flex gap-2",children:[Object(D.jsx)("div",{children:"Message:"}),Object(D.jsx)("div",{children:l})]})]});default:return Object(D.jsx)(W.a,{src:e.payload.params})}}(s)}),x=l?Object(D.jsx)("div",{className:"flex justify-start items-center gap-2",children:Object(D.jsx)(J,{disabled:!0,onClick:function(){},text:"Processing..."})}):Object(D.jsxs)("div",{className:"flex justify-start items-center gap-2",children:[Object(D.jsx)(J,{onClick:function(){b(),f(!0)},text:"Process"}),Object(D.jsx)(J,{onClick:v,text:"Reject"})]});return Object(D.jsx)("div",{className:"flex justify-center items-center",children:Object(D.jsx)(B,{header:p,body:j,footer:x})},s.id)};var F=function(e){var t=e.paused,r=e.socket,s=e.requests,a=e.setRequests,c=Object(M.b)(),i=c.account,o=c.library;Object(n.useEffect)((function(){var e=function(e){a((function(t){return t.filter((function(t){return t.id!==e}))}))};i&&o&&(t||(s.filter(m).forEach((function(t){!function(e,t){var r,n='Method "'.concat(e.payload.method,'" is unsupported by @truffle/dashboard'),s=null!==(r={eth_sign:'Method "eth_sign" is unsupported by @truffle/dashboard, please use "personal_sign" instead'}[e.payload.method])&&void 0!==r?r:n,a={id:e.id,payload:{jsonrpc:e.payload.jsonrpc,id:e.payload.id,error:{code:4001,message:s}}};w(a,t)}(t,r),e(t.id)})),s.filter((function(e){return!g(e)&&!m(e)})).forEach((function(t){y(t,o.provider,r),e(t.id)}))))}),[t,s,a,r,i,o]);var u=i&&o&&r?s.filter(g).map((function(e){return Object(D.jsx)(L,{request:e,setRequests:a,provider:o.provider,socket:r})})):[];return Object(D.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(D.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3",children:Object(D.jsx)(B,{header:"Incoming Requests",body:u})})})},Y=r(102);var U=function(e){var t=e.confirm,r=Object(M.b)(),n=r.chainId,s=r.activate,a=new Y.a({}),c=Object(D.jsx)(J,{text:"Connect Wallet",onClick:function(){return s(a)}}),i=n&&Object(D.jsxs)("div",{className:"flex flex-col gap-2",children:[Object(D.jsx)("div",{children:"Please confirm you're connected to the right network (or switch to the right one) before continuing."}),Object(D.jsx)("div",{className:"flex justify-center",children:Object(D.jsx)(I,{chainId:n})})]}),o=Object(D.jsx)(J,{text:"Confirm",onClick:t});return Object(D.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(D.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3 text-center",children:void 0===n?Object(D.jsx)(B,{header:"Connect Wallet",body:"Please connect your wallet to use the Truffle Dashboard Provider.",footer:c}):Object(D.jsx)(B,{header:"Connect Wallet",body:i,footer:o})})})};var z=function(e){var t=e.confirm,r=e.newChainId,n=e.previousChainId,s=Object(D.jsxs)("div",{className:"flex flex-col gap-2",children:[Object(D.jsx)("div",{children:"We detected that your connected network changed. Please confirm that this was your intention or switch back to the previous network."}),Object(D.jsx)("div",{children:"Your previous connected network was:"}),Object(D.jsx)("div",{className:"flex justify-center",children:Object(D.jsx)(I,{chainId:n})}),Object(D.jsx)("div",{children:"Your new connected network is:"}),Object(D.jsx)("div",{className:"flex justify-center",children:Object(D.jsx)(I,{chainId:r})})]}),a=Object(D.jsx)(J,{text:"Confirm",onClick:t});return Object(D.jsx)("div",{className:"flex justify-center items-center py-20",children:Object(D.jsx)("div",{className:"mx-3 w-3/4 max-w-4xl h-2/3 text-center",children:Object(D.jsx)(B,{header:"Confirm Network Changed",body:s,footer:a})})})};var G=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),r=t[0],s=t[1],a=Object(n.useState)(),c=Object(i.a)(a,2),u=c[0],f=c[1],h=Object(n.useState)(),b=Object(i.a)(h,2),v=b[0],p=b[1],j=Object(n.useState)([]),g=Object(i.a)(j,2),m=g[0],O=g[1],y=Object(M.b)().chainId;Object(n.useEffect)((function(){y&&v&&(u?(u!==y&&s(!0),u===y&&s(!1)):f(y))}),[y,u,v]);var w=function(){var e=Object(o.a)(d.a.mark((function e(){var t,r,n,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||v.readyState!==q.a.OPEN){e.next=2;break}return e.abrupt("return");case 2:return t=window.location.hostname,e.next=5,x();case 5:return r=e.sent,n=r.subscribePort,e.next=9,Object(l.connectToMessageBusWithRetries)(n,t);case 9:(s=e.sent).addEventListener("message",(function(e){"string"!==typeof e.data&&(e.data=e.data.toString());var t=Object(l.base64ToJson)(e.data);console.debug("Received message",t),Object(l.isDashboardProviderMessage)(t)?O((function(e){return[].concat(Object(N.a)(e),[t])})):Object(l.isInvalidateMessage)(t)&&O((function(e){return e.filter((function(e){return e.id!==t.payload}))}))})),s.send("ready"),p(s);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"h-full min-h-screen bg-gradient-to-b from-truffle-lighter to-truffle-light",children:[Object(D.jsx)(E,{}),r&&y&&u&&Object(D.jsx)(z,{newChainId:y,previousChainId:u,confirm:function(){return f(y)}}),!r&&!v&&Object(D.jsx)(U,{confirm:w}),!r&&v&&Object(D.jsx)(F,{paused:r,socket:v,requests:m,setRequests:O})]})};var H=function(){return Object(D.jsx)(M.a,{getLibrary:k,children:Object(D.jsx)(G,{})})};r(231);c.a.render(Object(D.jsx)(s.a.StrictMode,{children:Object(D.jsx)(H,{})}),document.getElementById("root"))},58:function(e,t,r){"use strict";(function(e){var n=r(0),s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,a){function c(e){try{o(n.next(e))}catch(t){a(t)}}function i(e){try{o(n.throw(e))}catch(t){a(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,i)}o((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageBusPorts=t.connectToMessageBus=t.connectToMessageBusWithRetries=t.sendAndAwait=t.broadcastAndAwaitFirst=t.broadcastAndDisregard=t.createMessage=t.startWebSocketServer=t.base64ToJson=t.jsonToBase64=void 0;var c=a(r(52)),i=a(r(129)),o=a(r(57)),u=a(r(53));i.default.shim();t.jsonToBase64=function(t){var r=JSON.stringify(t);return e.from(r).toString("base64")};t.base64ToJson=function(t){var r=e.from(t,"base64").toString("utf8");return JSON.parse(r)};t.startWebSocketServer=function(e){return new Promise((function(t){var r=new c.default.Server(e,(function(){return t(r)}))}))};t.createMessage=function(e,t){return{id:Math.random(),type:e,payload:t}};t.broadcastAndDisregard=function(e,r){var n=t.jsonToBase64(r);e.forEach((function(e){e.send(n)}))};t.broadcastAndAwaitFirst=function(e,r){return s(void 0,void 0,void 0,n.mark((function s(){var a,c;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.map((function(e){return t.sendAndAwait(e,r)})),n.next=3,Promise.any(a);case 3:return c=n.sent,n.abrupt("return",c);case 5:case"end":return n.stop()}}),s)})))};t.sendAndAwait=function(e,r){return new Promise((function(n,s){e.addEventListener("message",(function(e){"string"!==typeof e.data&&(e.data=e.data.toString());var s=t.base64ToJson(e.data);s.id===r.id&&n(s)})),e.addEventListener("error",(function(e){s(e.error)})),e.addEventListener("close",(function(e){s(new Error("Socket connection closed with code '".concat(e.code,"' and reason '").concat(e.reason,"'")))}));var a=t.jsonToBase64(r);e.send(a)}))};t.connectToMessageBusWithRetries=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"localhost",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return s(void 0,void 0,void 0,n.mark((function s(){var c,i;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c=new Error,i=0;case 2:if(!(i<a)){n.next=17;break}return n.prev=3,n.next=6,t.connectToMessageBus(e,r);case 6:return n.abrupt("return",n.sent);case 9:return n.prev=9,n.t0=n.catch(3),c=n.t0,n.next=14,o.default(1e3);case 14:i+=1,n.next=2;break;case 17:throw c;case 18:case"end":return n.stop()}}),s,null,[[3,9]])})))};t.connectToMessageBus=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"localhost",r=new c.default("ws://".concat(t,":").concat(e));return new Promise((function(e,t){r.addEventListener("open",(function(){return e(r)})),r.addEventListener("error",(function(e){return t(e.error)}))}))};t.getMessageBusPorts=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"localhost",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return s(void 0,void 0,void 0,n.mark((function s(){var a,c,i;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=0;case 1:if(!(a<r)){n.next=17;break}return n.prev=2,n.next=5,u.default.get("http://".concat(t,":").concat(e,"/ports"));case 5:return c=n.sent,i=c.data,n.abrupt("return",i);case 10:return n.prev=10,n.t0=n.catch(2),n.next=14,o.default(1e3);case 14:a+=1,n.next=1;break;case 17:throw new Error("Could not connect to dashboard at http://".concat(t,":").concat(e,"/ports"));case 18:case"end":return n.stop()}}),s,null,[[2,10]])})))}}).call(this,r(125).Buffer)}},[[232,1,2]]]);
//# sourceMappingURL=main.7a85ce53.chunk.js.map